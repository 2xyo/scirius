{% extends "rules/base.html" %}

{% block body %}
<body onload="differentiate_suppressed();" />
{% endblock %}

{% block content %}

<script language="JavaScript">
function differentiate_suppressed() {
    var arr = [{{ suppressed }}];
    $(".sid").each(function() {
        if (jQuery.inArray(parseInt($( this ).text(), 10), arr) != -1)
            $( this ).addClass("suppressed")
    })
}
</script>

{% if rules %}
<h2 class="title">Rules activity (last 24h)</h2>

{% load render_table from django_tables2 %}

{% render_table rules %}
{% endif %}

{% endblock %}

{% block sidebar %}
<h2>Suricata {{ suricata.name }}</h2>
<ul>
       <li><span class="type">Ruleset:</span> {{ suricata.ruleset }}</li>
       <li><span class="type">Description:</span> {{ suricata.descr }}</li>
       <li><span class="type">Last updated:</span> {{ suricata.updated_date }}</li>
</ul>

<h2 >Action</h2>
<ul class="action">
<li>
<a href="/suricata/update">Update</a>
</li>
<li>
<a href="/suricata/edit">Edit</a>
</li>
</ul>

{% endblock %}
